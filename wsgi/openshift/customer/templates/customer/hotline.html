{% extends 'base.html' %}
{% load boots %}

{% block title %}Обратная связь с «Деливери»{% endblock %}

{% block custom_style %}
  .form-solid {
    padding: 15px;
    margin: 0 auto;
  }
  .form-solid .form-control {
    position: relative;
    height: auto;
    -webkit-box-sizing: border-box;
       -moz-box-sizing: border-box;
            box-sizing: border-box;
    border-radius: 0;
    margin-bottom: -1px;
    padding: 10px;
    font-size: 16px;
  }
  .form-solid .form-control:focus {
    z-index: 2;
  }
  .form-solid .form-control.first {
    border-radius: 4px 4px 0 0;
  }
  .form-solid .form-control.last {
    border-radius: 0 0 4px 4px;
    margin-bottom: 10px;
  }
  .popover {
    background-color: #f2dede;
    border-color: #ebccd1;
    color: #a94442;
  }
  .popover .popover-content {
    padding-right: 35px;
  }
  .popover .close {
    position: relative;
    top: -2px;
    right: -21px;
    color: inherit;
  }
  .popover .close:hover, .popover .close:focus {
    color: #000000;
  }
  .popover p, .popover ul {
    margin-bottom: 0;
  }
  .popover.right .arrow {
    border-right-color: #ebccd1;
  }
  .popover.right .arrow:after {
    border-right-color: #f2dede;
  }
  .popover.bottom .arrow {
    border-bottom-color: #ebccd1;
  }
  .popover.bottom .arrow:after {
    border-bottom-color: #f2dede;
  }
{% endblock %}

{% block content %}
  <div class="row">
    <div class="col-md-8 col-md-offset-2">
      <form role="form" class="form-solid" action="" method="post">{% csrf_token %}
        <h2>Обратная связь</h2>
        <p>Задайте вопрос или выскажите ваши предложения</p>
        {% b_input form.subject 'autofocus' type='text' spec_class='first' %}
        {% b_input form.email type='email' %}
        {% b_textarea form.text rows='10' spec_class='last' %}
        <button type="submit" class="btn btn-lg btn-primary btn-block">Отправить</button>
      </form>
    </div>
  </div>
{% endblock %}

{% block custom_script %}
  {% if form.has_field_errors %}
  <script>
    function popover_placement(po, el) {
      var win_width = window.innerWidth;
      var el_right = $(el).offset().left + $(el).outerWidth(true);
      if ((win_width - el_right) < 280)
        return 'bottom';
      return 'right';
    }
    function popover_content() {
      var btn_close = '<button type="button" class="close" data-fld="#' +
                      $(this).attr('id') + '">&times;</button>';
      return btn_close + $(this).data('errors');
    }
    $(document).ready(function () {
      var popover_sets = {
        container: 'body',
        trigger: 'manual',
        placement: popover_placement,
        html: true,
        content: popover_content
      };
      var flds = $('[rel="popover"]');
      flds.popover(popover_sets);
      if (flds.length > 1) {
        flds.each(function (i) {
          $(this).on('show.bs.popover', function () {
            var popover = $(this).data('bs.popover').tip();
            popover.css('z-index', 1010 - i);
          });
        });
      }
      flds.popover('show');
    });
    $(document).click(function (e) {
      if ($(e.target).is('.popover .close'))
        $($(e.target).data('fld')).popover('destroy');
    });
    $(window).resize(function () {
      if ($('.popover').length > 0)
        $('[rel="popover"]').popover('show');
    });
  </script>
  {% endif %}
{% endblock %}
